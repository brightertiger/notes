# Rec Sys

-   Feedback
    -   Explicit
        -   Rating, Like or Dislike from users
        -   Sparse, Values missing at at random
    -   Implicit
        -   Monitor user actions - click vs no-click, watch vs skip etc.
        -   Sparse positive-only ratings matrix
-   Collaborative Filtering
    -   Users collaborate on recmmending items
    -   Impute values by looking at how other similar users have rated the item
    -   $\hat Y_{ui} = \sum sim(u_i, u') Y_{u', i}$
    -   Typical approach to calculate similarity is to compare the available ratings from both users
    -   Data Sprsity makes it challenging
    -   Matrix Factorization
        -   View the problem as that of matrix completion
        -   Predict all the missing entries of the ratings matrix
        -   Optimization: $L = ||Z - Y||^2$
        -   Break up Z into low rank matrices: $Z = U^TV$
        -   U is the matrix corresponding to users, V is the matrix corresponding to items
        -   Since Y is incomplete, Z can't be found using SVD. (unless missing imputation)
        -   Use ALS (Alternating Least Squares). Estimate U given V and V given U.
        -   Add user-specific and item specific biases
        -   $\hat y_{ui} = \mu + b_u + c_i + u_u^T v_i$
        -   $L = \sum (y_{ui} - \hat y_{ui})^2$
    -   Probabilistic Matrix Factorization
        -   Convert the ratings to a probabilistic model
        -   $p(Y=y) = N(\mu + b_u + c_i + u_u^T v_i, \sigma^2)$
-   Bayesian Personalized Ranking
    -   Implicit Feedback
    -   Ranking Loss: Model ranks item i (positive set) ahead of j (negative set) for user u
        -   $p(y = (u,i,j) | \theta) = \sigma(f(u,i;\theta) - f(u,j;\theta))$
    -   Use hinge-loss to estimate the parameters
-   Factorization Machines
    -   Predict the rating for each user-item pair using one-hot encodings
        -   $x = \text{concat}[user, item]$
    -   $f(x) = \mu + \sum w_i x_i + \sum \sum (v_i v_j) x_i x_j$
    -   The dot product captures the interactions between users, items and user-items.
    -   Using a low-rank matrix it reduces the number of parameters to be estimated.
    -   Adding contextual information to solve for cold-start is straight forward.
    -   If explicit feedback, use MSE Loss.
    -   If implicit feedback, use Ranking Loss.
-   Cold-Start Problem
    -   Difficult to generate predictions for new user or new item.
    -   Leverage side information. Item and user metadata.
-   Exploration-Exploitation Tradeoff
    -   Counterfactual - Is there an item the user would have liked but wasn't shown?
    -   Recommend items for which response is uncertain. 